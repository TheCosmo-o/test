<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

<style>
body {
  font-family: "Segoe UI", sans-serif;
  background: linear-gradient(to bottom, #d6e3b3, #a9c27d);
  margin: 0;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card {
  background: #ffffff; /* zmieniono tÅ‚o na biaÅ‚e */
  border-radius: 1.5rem;
  padding: 3rem;
  box-shadow: 0 12px 30px rgba(0,0,0,0.15);
  width: 500px;
  max-width: 95%;
  text-align: center;
  border: 2px solid #b17c3a;
  transition: width 0.3s, padding 0.3s, border-radius 0.3s, box-shadow 0.3s;
}

@media (max-width: 600px) {
  .card {
    width: 100%;
    height: 100vh;
    border-radius: 0;
    padding: 2rem;
    box-shadow: none;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    overflow-y: auto;
  }
}

.hedgehog img {
  width: 130px;
  height: 130px;
}

@media (max-width: 600px) {
  .hedgehog img {
    width: 180px;
    height: 180px;
  }
}

.bar { height: 10px; background: #e0d7c2; border-radius: 10px; overflow: hidden; margin: 8px 0 20px; }
.fill { height: 100%; background: linear-gradient(to right, #b17c3a, #d9a05b); width: 50%; transition: width 0.3s; }

.task { border: 1px solid #c5a670; background: #fffdf6; padding: 8px; border-radius: 8px; margin: 6px 0; cursor: pointer; user-select: none; transition: background 0.3s; display: flex; justify-content: space-between; align-items: center; }
.task:hover { background: #f3e6c7; }
.task.done { background: #d8e3b9; text-decoration: line-through; color: #5b4a27; }

button { background: #b17c3a; color: white; border: none; border-radius: 8px; padding: 10px 16px; cursor: pointer; font-weight: bold; transition: background 0.3s; }
button:hover { background: #8c5f25; }

.add-task { display: flex; gap: 6px; margin-bottom: 14px; margin-top:10%; }
.add-task input { flex: 1; padding: 8px; border: 1px solid #c5a670; border-radius: 8px; font-size: 0.9rem; background: #fffdf6; }
.add-task input:focus { outline: none; border-color: #b17c3a; box-shadow: 0 0 4px #d9a05b; }
.add-task button { background: #b17c3a; color: white; border: none; border-radius: 8px; padding: 8px 10px; cursor: pointer; font-weight: bold; transition: background 0.3s; }
.add-task button:hover { background: #8c5f25; }

.delete-btn { background: none; border: none; color: #8c5f25; font-size: 1rem; cursor: pointer; transition: color 0.2s; }
.delete-btn:hover { color: #b91c1c; }

#moodChart { margin-top: 20px; max-width: 100%; height: 150px; }

</style>
</head>

<body>
<div class="card">
  <h1>ðŸ¦” Stefek ðŸ¦” </h1>

  <div id="hamster" class="hedgehog">
    <img id="hamsterImg" src="zdj1.png" alt="Chomik" width="120" height="120" />
  </div>

  <p>NastrÃ³j: <span id="mood">0</span>/100</p>
  <div class="bar"><div class="fill" id="bar"></div></div>

  <div id="tasks"></div>
  <button id="reset">ðŸ”„ Nowy dzieÅ„</button> <br>

  <div class="add-task">
    <input id="newTaskText" type="text" placeholder="âœï¸ Nowe zadanie..." />
    <button id="addTask">âž• Dodaj</button>
  </div>

  <canvas id="moodChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- DOMYÅšLNE ZADANIA ---
const tasksDefault = [
  { id: 1, text: "Umyj zÄ™by", done: false },
  { id: 2, text: "Napij siÄ™ wody", done: false },
  { id: 3, text: "ZrÃ³b 1 gÅ‚Ä™boki oddech", done: false },
  { id: 4, text: "PosÅ‚uchaj ulubionej muzyki", done: false },
  { id: 5, text: "ZrÃ³b maÅ‚y spacer lub wyjrzyj za okno", done: false },
  { id: 6, text: "Napisz 1 pozytywnÄ… rzecz o sobie", done: false },
];

let tasks = JSON.parse(localStorage.getItem("tasks")) || tasksDefault;
let savedMood = localStorage.getItem("mood");
let mood = savedMood !== null ? JSON.parse(savedMood) : 0;

const hamsterImg = document.getElementById("hamsterImg");
const moodText = document.getElementById("mood");
const bar = document.getElementById("bar");
const tasksDiv = document.getElementById("tasks");

let moodHistory = JSON.parse(localStorage.getItem("moodHistory")) || [];

// --- FUNKCJE ---
function updateHamster() {
  moodText.textContent = mood;
  bar.style.width = mood + "%";
}

function save() {
  localStorage.setItem("tasks", JSON.stringify(tasks));
  localStorage.setItem("mood", JSON.stringify(mood));

  const today = new Date().toISOString().slice(0,10);
  const todayEntry = moodHistory.find(h => h.date === today);

  if (todayEntry) {
    todayEntry.mood = mood;  // aktualizujemy dzisiejszy nastrÃ³j
  } else {
    moodHistory.push({ date: today, mood: mood }); // dodajemy nowy dzieÅ„
  }

  localStorage.setItem("moodHistory", JSON.stringify(moodHistory));
  updateChart();
}

// Renderowanie zadaÅ„
function renderTasks() {
  tasksDiv.innerHTML = "";
  tasks.forEach(t => {
    const el = document.createElement("div");
    el.className = "task" + (t.done ? " done" : "");

    const text = document.createElement("span");
    text.textContent = t.text;
    text.onclick = () => toggleTask(t.id);

    const delBtn = document.createElement("button");
    delBtn.textContent = "âŒ";
    delBtn.className = "delete-btn";
    delBtn.onclick = (e) => { e.stopPropagation(); deleteTask(t.id); };

    el.appendChild(text);
    el.appendChild(delBtn);
    tasksDiv.appendChild(el);
  });
}

function showHamsterGif(gif) {
  hamsterImg.src = gif;
  setTimeout(() => { hamsterImg.src = "zdj1.png"; }, 2000);
}

function toggleTask(id) {
  const task = tasks.find(t => t.id === id);
  const wasDone = task.done;
  task.done = !task.done;

  if (!wasDone && task.done) { mood = Math.min(100, mood + 15); showHamsterGif("gif1.gif"); }
  else if (wasDone && !task.done) { mood = Math.max(0, mood - 15); showHamsterGif("gif2.gif"); }

  save();
  updateHamster();
  renderTasks();
}

function deleteTask(id) {
  tasks = tasks.filter(t => t.id !== id);
  save();
  renderTasks();
}

document.getElementById("addTask").onclick = () => {
  const input = document.getElementById("newTaskText");
  const text = input.value.trim();
  if (text === "") return;

  tasks.push({ id: Date.now(), text: text, done: false });
  save();
  renderTasks();
  input.value = "";
};

document.getElementById("newTaskText").addEventListener("keypress", (e) => {
  if (e.key === "Enter") document.getElementById("addTask").click();
});

document.getElementById("reset").onclick = () => {
  tasks = tasks.map(t => {
    const defaultTask = tasksDefault.find(dt => dt.id === t.id);
    if (defaultTask) return { ...t, done: false };
    return t;
  });
  mood = 0;
  save();
  updateHamster();
  renderTasks();
  hamsterImg.src = "zdj1.png";
};

// --- CHART.JS ---
const ctx = document.getElementById('moodChart').getContext('2d');
let chart = new Chart(ctx, {
  type: 'line',
  data: { labels: [], datasets: [{ label: 'NastrÃ³j', data: [], borderColor: '#b17c3a', backgroundColor: 'rgba(177,124,58,0.2)', fill:true }] },
  options: { responsive:true, scales: { y: { min:0, max:100 } } }
});

function updateChart() {
  chart.data.labels = moodHistory.map(h => h.date);
  chart.data.datasets[0].data = moodHistory.map(h => h.mood);
  chart.update();
}

// --- URUCHOMIENIE ---
updateHamster();
renderTasks();
updateChart();
</script>
</body>
</html>
